<Window x:Class="ExcellCore.Shell.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ExcellCore"
        Height="450"
        Width="800">
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <TextBlock Text="ExcellCore Modular ERP"
               FontSize="20"
               FontWeight="Bold"
               Margin="16"/>
    <TextBlock Grid.Row="1"
               Text="{Binding StatusMessage}"
               FontSize="14"
               Foreground="Gray"
               Margin="16,0,16,8"/>

    <StackPanel Grid.Row="2"
                Orientation="Horizontal"
                Margin="16,0,16,8"
                VerticalAlignment="Center">
      <TextBlock Text="Localization Context"
                 FontSize="13"
                 Margin="0,0,8,0"/>
      <ComboBox Width="220"
                ItemsSource="{Binding AvailableLocalizationContexts}"
                SelectedItem="{Binding SelectedLocalizationContext, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    </StackPanel>

    <Border Grid.Row="3"
            Margin="16,0,16,8"
            BorderThickness="1"
            Padding="12"
            CornerRadius="4">
      <Border.Style>
        <Style TargetType="Border">
          <Setter Property="Background"
                  Value="#FFE6F5ED"/>
          <Setter Property="BorderBrush"
                  Value="#FF58A05E"/>
          <Style.Triggers>
            <DataTrigger Binding="{Binding TelemetrySeverity}"
                         Value="Warning">
              <Setter Property="Background"
                      Value="#FFFFF4E5"/>
              <Setter Property="BorderBrush"
                      Value="#FFE0C97F"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding TelemetrySeverity}"
                         Value="Critical">
              <Setter Property="Background"
                      Value="#FFFFEAEA"/>
              <Setter Property="BorderBrush"
                      Value="#FFD9534F"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding TelemetrySeverity}"
                         Value="Unknown">
              <Setter Property="Background"
                      Value="#FFE1F5FE"/>
              <Setter Property="BorderBrush"
                      Value="#FF82B1FF"/>
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </Border.Style>
      <StackPanel>
        <TextBlock Text="{Binding TelemetrySeverity}"
                   FontSize="14"
                   FontWeight="Bold">
          <TextBlock.Style>
            <Style TargetType="TextBlock">
              <Setter Property="Foreground"
                      Value="#FF1A6F3B"/>
              <Style.Triggers>
                <DataTrigger Binding="{Binding TelemetrySeverity}"
                             Value="Warning">
                  <Setter Property="Foreground"
                          Value="#FF8B6F00"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TelemetrySeverity}"
                             Value="Critical">
                  <Setter Property="Foreground"
                          Value="#FFD9534F"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TelemetrySeverity}"
                             Value="Unknown">
                  <Setter Property="Foreground"
                          Value="#FF0A2F5A"/>
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </TextBlock.Style>
        </TextBlock>
        <TextBlock Text="{Binding TelemetryMessage}"
                   FontSize="13"
                   Foreground="#FF0A2F5A"
                   Margin="0,4,0,0"
                   TextWrapping="Wrap"/>
        <TextBlock Text="{Binding TelemetrySummary}"
                   FontSize="12"
                   Foreground="#FF46637B"
                   Margin="0,4,0,0"
                   TextWrapping="Wrap"/>
        <TextBlock Text="{Binding EscalationStatus}"
                   FontSize="12"
                   Foreground="#FF46637B"
                   Margin="0,8,0,0"
                   TextWrapping="Wrap"/>
      </StackPanel>
    </Border>

    <Border Grid.Row="4"
            Margin="16,0,16,8"
            Background="#FFFDF6E3"
            BorderBrush="#FFE0C97F"
            BorderThickness="1"
            Padding="8">
      <Border.Style>
        <Style TargetType="Border">
          <Setter Property="Visibility"
                  Value="Visible"/>
          <Style.Triggers>
            <DataTrigger Binding="{Binding Notifications.Count}"
                         Value="0">
              <Setter Property="Visibility"
                      Value="Collapsed"/>
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </Border.Style>
      <ItemsControl ItemsSource="{Binding Notifications}">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <StackPanel Orientation="Horizontal"
                        Margin="0,2">
              <TextBlock Text="{Binding Severity}"
                         FontWeight="Bold"
                         Foreground="#FF8B6F00"
                         Margin="0,0,8,0"/>
              <TextBlock Text="{Binding TimestampUtc, StringFormat=\{\}{0:HH:mm}}"
                         Foreground="Gray"
                         Margin="0,0,8,0"/>
              <TextBlock Text="{Binding Message}"
                         TextWrapping="Wrap"/>
            </StackPanel>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </Border>

    <Grid Grid.Row="5"
          Margin="16">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="260"/>
        <ColumnDefinition Width="16"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <ListView ItemsSource="{Binding LoadedModules}"
                SelectedItem="{Binding SelectedModule, Mode=TwoWay}"
                Grid.Column="0"
                BorderBrush="#FFDDDDDD"
                BorderThickness="1">
        <ListView.ItemTemplate>
          <DataTemplate>
            <StackPanel>
              <TextBlock Text="{Binding DisplayName}"
                         FontWeight="SemiBold"/>
              <TextBlock Text="{Binding ModuleId}"
                         FontSize="12"
                         Foreground="Gray"/>
            </StackPanel>
          </DataTemplate>
        </ListView.ItemTemplate>
      </ListView>

      <ContentControl Grid.Column="2"
                      Content="{Binding ActiveModuleView}"
                      BorderBrush="#FFDDDDDD"
                      BorderThickness="1"
                      Padding="12"/>
    </Grid>
  </Grid>
</Window>
