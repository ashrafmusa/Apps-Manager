<UserControl x:Class="ExcellCore.Module.Extensions.Reporting.Views.TelemetryWorkspaceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Loaded="OnLoaded">
  <Grid Margin="16">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <StackPanel Orientation="Horizontal">
      <TextBlock Text="{Binding Title}"
          FontSize="20"
          FontWeight="SemiBold"/>
      <TextBlock Text="{Binding Subtitle}"
          Margin="12,0,0,0"
          Foreground="Gray"
          VerticalAlignment="Bottom"/>
    </StackPanel>

    <Border Grid.Row="1"
            Margin="0,16,0,16"
            Padding="16"
            CornerRadius="4">
      <Border.Style>
        <Style TargetType="Border"
            BasedOn="{StaticResource ModuleSummaryCardNeutralStyle}">
          <Setter Property="Background"
              Value="#FFE6F5ED"/>
          <Setter Property="BorderBrush"
              Value="#FF58A05E"/>
          <Style.Triggers>
            <DataTrigger Binding="{Binding Health.Severity}"
                Value="Warning">
              <Setter Property="Background"
                  Value="#FFFFF4E5"/>
              <Setter Property="BorderBrush"
                  Value="#FFE0C97F"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Health.Severity}"
                Value="Critical">
              <Setter Property="Background"
                  Value="#FFFFEAEA"/>
              <Setter Property="BorderBrush"
                  Value="#FFD9534F"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding Health.Severity}"
                Value="Unknown">
              <Setter Property="Background"
                  Value="#FFE1F5FE"/>
              <Setter Property="BorderBrush"
                  Value="#FF82B1FF"/>
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </Border.Style>
      <StackPanel>
        <TextBlock Text="{Binding Health.Severity}"
            FontSize="16"
            FontWeight="Bold">
          <TextBlock.Style>
            <Style TargetType="TextBlock">
              <Setter Property="Foreground"
                  Value="#FF1A6F3B"/>
              <Style.Triggers>
                <DataTrigger Binding="{Binding Health.Severity}"
                    Value="Warning">
                  <Setter Property="Foreground"
                      Value="#FF8B6F00"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Health.Severity}"
                    Value="Critical">
                  <Setter Property="Foreground"
                      Value="#FFD9534F"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Health.Severity}"
                    Value="Unknown">
                  <Setter Property="Foreground"
                      Value="#FF0A2F5A"/>
                </DataTrigger>
              </Style.Triggers>
            </Style>
          </TextBlock.Style>
        </TextBlock>
        <TextBlock Text="{Binding Health.Message}"
            FontSize="13"
            Foreground="#FF0A2F5A"
            Margin="0,6,0,0"
            TextWrapping="Wrap"/>
        <TextBlock Text="{Binding Health.Summary}"
            FontSize="12"
            Foreground="#FF46637B"
            Margin="0,4,0,0"
            TextWrapping="Wrap"/>
        <TextBlock Text="{Binding Health.CapturedDisplay, StringFormat=Captured {0}}"
            FontSize="12"
            Foreground="Gray"
            Margin="0,4,0,0"/>
      </StackPanel>
    </Border>

    <Grid Grid.Row="2">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="3*"/>
        <ColumnDefinition Width="0.5*"/>
        <ColumnDefinition Width="2*"/>
      </Grid.ColumnDefinitions>

      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="{Binding TrendLabel}"
            FontWeight="SemiBold"
            FontSize="14"/>

        <ListBox Grid.Row="1"
                 Margin="0,8,0,0"
                 ItemsSource="{Binding Aggregates}"
                 BorderBrush="#FFDDDDDD"
                 BorderThickness="1">
          <ListBox.ItemTemplate>
            <DataTemplate>
              <Border Margin="4"
                      Padding="12"
                      CornerRadius="4">
                <Border.Style>
                  <Style TargetType="Border"
                      BasedOn="{StaticResource ModuleSummaryCardNeutralStyle}">
                    <Setter Property="Background"
                        Value="#FFF7FBF9"/>
                    <Setter Property="BorderBrush"
                        Value="#FFCCE7DE"/>
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding Severity}"
                          Value="Warning">
                        <Setter Property="Background"
                            Value="#FFFFFAF0"/>
                        <Setter Property="BorderBrush"
                            Value="#FFEAD8A1"/>
                      </DataTrigger>
                      <DataTrigger Binding="{Binding Severity}"
                          Value="Critical">
                        <Setter Property="Background"
                            Value="#FFFFF0F0"/>
                        <Setter Property="BorderBrush"
                            Value="#FFE7A5A5"/>
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </Border.Style>
                <StackPanel>
                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding WindowLabel}"
                        FontWeight="SemiBold"/>
                    <TextBlock Grid.Column="1"
                        Text="{Binding Severity}"
                        Margin="12,0,0,0"
                        FontWeight="Bold"/>
                  </Grid>
                  <TextBlock Text="{Binding DetailLabel}"
                      Margin="0,4,0,0"/>
                  <StackPanel Orientation="Horizontal"
                      Margin="0,4,0,0">
                    <TextBlock Text="Samples:"
                        FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding SampleCount}"
                        Margin="4,0,0,0"/>
                    <TextBlock Text="Warnings:"
                        FontWeight="SemiBold"
                        Margin="16,0,0,0"/>
                    <TextBlock Text="{Binding WarningCount}"
                        Margin="4,0,0,0"/>
                    <TextBlock Text="Critical:"
                        FontWeight="SemiBold"
                        Margin="16,0,0,0"/>
                    <TextBlock Text="{Binding CriticalCount}"
                        Margin="4,0,0,0"/>
                  </StackPanel>
                </StackPanel>
              </Border>
            </DataTemplate>
          </ListBox.ItemTemplate>
        </ListBox>
      </Grid>

      <Border Grid.Column="2"
              Margin="0,0,0,0"
              Padding="16">
        <Border.Style>
          <Style TargetType="Border"
              BasedOn="{StaticResource ModuleSummaryCardNeutralStyle}"/>
        </Border.Style>
        <StackPanel>
          <TextBlock Text="{Binding SeverityBreakdownLabel}"
              FontWeight="SemiBold"
              FontSize="14"/>
          <ItemsControl ItemsSource="{Binding SeverityBreakdown}"
              Margin="0,8,0,0">
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <StackPanel Orientation="Horizontal"
                    Margin="0,4,0,4">
                  <TextBlock Text="{Binding Severity}"
                      Width="80"/>
                  <Border Width="48"
                      Height="24"
                      CornerRadius="12"
                      VerticalAlignment="Center">
                    <Border.Style>
                      <Style TargetType="Border">
                        <Setter Property="Background"
                            Value="#FFE6F5ED"/>
                        <Style.Triggers>
                          <DataTrigger Binding="{Binding Severity}"
                              Value="Warning">
                            <Setter Property="Background"
                                Value="#FFFFF4E5"/>
                          </DataTrigger>
                          <DataTrigger Binding="{Binding Severity}"
                              Value="Critical">
                            <Setter Property="Background"
                                Value="#FFFFEAEA"/>
                          </DataTrigger>
                          <DataTrigger Binding="{Binding Severity}"
                              Value="Unknown">
                            <Setter Property="Background"
                                Value="#FFE1F5FE"/>
                          </DataTrigger>
                        </Style.Triggers>
                      </Style>
                    </Border.Style>
                    <TextBlock Text="{Binding CountDisplay}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontWeight="SemiBold"/>
                  </Border>
                </StackPanel>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </StackPanel>
      </Border>
    </Grid>

    <DockPanel Grid.Row="3"
        Margin="0,16,0,0">
      <Button DockPanel.Dock="Right"
              Content="{Binding RefreshLabel}"
              Width="96"
              Height="32"
              Command="{Binding RefreshCommand}"/>
      <TextBlock Text="{Binding StatusMessage}"
          VerticalAlignment="Center"
          Foreground="Gray"/>
    </DockPanel>
  </Grid>
</UserControl>
